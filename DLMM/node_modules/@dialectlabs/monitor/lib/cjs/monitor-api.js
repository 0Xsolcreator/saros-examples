"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Monitors = void 0;
const default_monitor_factory_1 = require("./internal/default-monitor-factory");
const monitor_builder_1 = require("./internal/monitor-builder");
/**
 * A main entry point that provides API to create new monitors either by step-by-step builder or factory
 */
class Monitors {
    /**
     * A rich builder that guides developer on monitor creation step
     /**
     * Example:
     *
     * ```typescript
     * Monitors.builder({
     *  subscriberRepository: xxx,
     *  notificationSink: xxx,
     * })
     * .subscriberEvents()
     * .transform<SubscriberState>({
     *   keys: ['state'],
     *   pipelines: [
     *     Pipelines.sendMessageToNewSubscriber({
     *       title: 'Welcome title',
     *       messageBuilder: () => `Hi! Welcome onboard :)`,
     *     }),
     *   ],
     * })
     * .dispatch('unicast')
     * .build()
     * .start()
     * // run typedoc --help for a list of supported languages
     * const instance = new MyClass();
     * ```
     */
    static builder(monitorProps) {
        return new monitor_builder_1.ChooseDataSourceStepImpl(monitorProps);
    }
    /**
     * A more low-level way to create monitors
     */
    static factory(subscriberRepository) {
        if (!Monitors.factoryInstance) {
            Monitors.factoryInstance = new default_monitor_factory_1.DefaultMonitorFactory(subscriberRepository);
        }
        return Monitors.factoryInstance;
    }
    /**
     * Shutdowns monitor app and closes all related resources
     */
    static async shutdown() {
        return Monitors.factoryInstance && Monitors.factoryInstance.shutdown();
    }
}
exports.Monitors = Monitors;

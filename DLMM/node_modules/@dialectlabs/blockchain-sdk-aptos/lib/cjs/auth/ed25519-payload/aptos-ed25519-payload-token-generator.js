"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AptosEd25519PayloadTokenGenerator = void 0;
const tslib_1 = require("tslib");
const sdk_1 = require("@dialectlabs/sdk");
class AptosEd25519PayloadTokenGenerator extends sdk_1.TokenGenerator {
    generate(ttl) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const header = this.header();
            const base64Header = (0, sdk_1.jsonStringifyToBase64)(header);
            const body = this.body(ttl);
            const base64Body = (0, sdk_1.jsonStringifyToBase64)(body);
            const { signature, base64Signature, signedPayload } = yield this.sign(base64Header, base64Body, this.signer);
            const base64SignedBody = (0, sdk_1.bytesToBase64)(signedPayload);
            const rawValue = `${base64Header}.${base64SignedBody}.${base64Signature}`;
            return {
                rawValue,
                body,
                header,
                signature,
                base64Signature,
                base64Body: base64SignedBody,
                base64Header,
            };
        });
    }
}
exports.AptosEd25519PayloadTokenGenerator = AptosEd25519PayloadTokenGenerator;
//# sourceMappingURL=aptos-ed25519-payload-token-generator.js.map
{"version":3,"file":"aptos-ed25519-payload-token-generator.js","sourceRoot":"","sources":["../../../../src/auth/ed25519-payload/aptos-ed25519-payload-token-generator.ts"],"names":[],"mappings":";;;;AAEA,0CAI0B;AAE1B,MAAa,iCAAkC,SAAQ,oBAAc;IACpD,QAAQ,CAAC,GAAa;;YACnC,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;YAC7B,MAAM,YAAY,GAAG,IAAA,2BAAqB,EAAC,MAAM,CAAC,CAAC;YAEnD,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC5B,MAAM,UAAU,GAAG,IAAA,2BAAqB,EAAC,IAAI,CAAC,CAAC;YAE/C,MAAM,EAAE,SAAS,EAAE,eAAe,EAAE,aAAa,EAAE,GAAG,MAAM,IAAI,CAAC,IAAI,CACnE,YAAY,EACZ,UAAU,EACV,IAAI,CAAC,MAAM,CACZ,CAAC;YAEF,MAAM,gBAAgB,GAAG,IAAA,mBAAa,EAAC,aAAa,CAAC,CAAC;YAEtD,MAAM,QAAQ,GAAG,GAAG,YAAY,IAAI,gBAAgB,IAAI,eAAe,EAAE,CAAC;YAC1E,OAAO;gBACL,QAAQ;gBACR,IAAI;gBACJ,MAAM;gBACN,SAAS;gBACT,eAAe;gBACf,UAAU,EAAE,gBAAgB;gBAC5B,YAAY;aACb,CAAC;QACJ,CAAC;KAAA;CACF;AA3BD,8EA2BC","sourcesContent":["import type { Duration } from 'luxon';\nimport type { Token } from '@dialectlabs/sdk';\nimport {\n  bytesToBase64,\n  jsonStringifyToBase64,\n  TokenGenerator,\n} from '@dialectlabs/sdk';\n\nexport class AptosEd25519PayloadTokenGenerator extends TokenGenerator {\n  override async generate(ttl: Duration): Promise<Token> {\n    const header = this.header();\n    const base64Header = jsonStringifyToBase64(header);\n\n    const body = this.body(ttl);\n    const base64Body = jsonStringifyToBase64(body);\n\n    const { signature, base64Signature, signedPayload } = await this.sign(\n      base64Header,\n      base64Body,\n      this.signer,\n    );\n\n    const base64SignedBody = bytesToBase64(signedPayload);\n\n    const rawValue = `${base64Header}.${base64SignedBody}.${base64Signature}`;\n    return {\n      rawValue,\n      body,\n      header,\n      signature,\n      base64Signature,\n      base64Body: base64SignedBody,\n      base64Header,\n    };\n  }\n}\n"]}
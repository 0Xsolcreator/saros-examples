{"version":3,"file":"aptos-ed25519-payload-token-body-parser.js","sourceRoot":"","sources":["../../../../src/auth/ed25519-payload/aptos-ed25519-payload-token-body-parser.ts"],"names":[],"mappings":";;;AACA,0CAK0B;AAE1B,MAAa,kCAAmC,SAAQ,qBAAe;IACrE,KAAK,CAAC,UAAkB;;QACtB,MAAM,QAAQ,GAAG,IAAA,qBAAe,EAAC,UAAU,CAAC,CAAC;QAC7C,MAAM,OAAO,GAAG,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACnD,MAAM,aAAa,GAAG,MAAA,MAAA,OAAO;aAC1B,KAAK,CAAC,IAAI,CAAC;aACX,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,0CACrC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,0CACb,IAAI,EAAE,CAAC;QACX,IAAI,CAAC,aAAa,EAAE;YAClB,MAAM,IAAI,mCAA6B,EAAE,CAAC;SAC3C;QACD,MAAM,CAAC,YAAY,EAAE,UAAU,CAAC,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC5D,IAAI,CAAC,YAAY,IAAI,CAAC,UAAU,EAAE;YAChC,MAAM,IAAI,mCAA6B,EAAE,CAAC;SAC3C;QACD,OAAO,IAAA,yBAAmB,EAAY,UAAU,CAAC,CAAC;IACpD,CAAC;CACF;AAlBD,gFAkBC","sourcesContent":["import type { TokenBody } from '@dialectlabs/sdk';\nimport {\n  bytesFromBase64,\n  jsonParseFromBase64,\n  TokenBodyParser,\n  TokenStructureValidationError,\n} from '@dialectlabs/sdk';\n\nexport class AptosEd25519PayloadTokenBodyParser extends TokenBodyParser {\n  parse(base64Body: string): TokenBody {\n    const byteBody = bytesFromBase64(base64Body);\n    const decoded = new TextDecoder().decode(byteBody);\n    const signedPayload = decoded\n      .split('\\n')\n      .find((it) => it.startsWith('message'))\n      ?.split(':')[1]\n      ?.trim();\n    if (!signedPayload) {\n      throw new TokenStructureValidationError();\n    }\n    const [headerBase64, bodyBase64] = signedPayload.split('.');\n    if (!headerBase64 || !bodyBase64) {\n      throw new TokenStructureValidationError();\n    }\n    return jsonParseFromBase64<TokenBody>(bodyBase64);\n  }\n}\n"]}
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AptosEd25519PayloadTokenBodyParser = void 0;
const sdk_1 = require("@dialectlabs/sdk");
class AptosEd25519PayloadTokenBodyParser extends sdk_1.TokenBodyParser {
    parse(base64Body) {
        var _a, _b;
        const byteBody = (0, sdk_1.bytesFromBase64)(base64Body);
        const decoded = new TextDecoder().decode(byteBody);
        const signedPayload = (_b = (_a = decoded
            .split('\n')
            .find((it) => it.startsWith('message'))) === null || _a === void 0 ? void 0 : _a.split(':')[1]) === null || _b === void 0 ? void 0 : _b.trim();
        if (!signedPayload) {
            throw new sdk_1.TokenStructureValidationError();
        }
        const [headerBase64, bodyBase64] = signedPayload.split('.');
        if (!headerBase64 || !bodyBase64) {
            throw new sdk_1.TokenStructureValidationError();
        }
        return (0, sdk_1.jsonParseFromBase64)(bodyBase64);
    }
}
exports.AptosEd25519PayloadTokenBodyParser = AptosEd25519PayloadTokenBodyParser;
//# sourceMappingURL=aptos-ed25519-payload-token-body-parser.js.map
import { bytesFromBase64, jsonParseFromBase64, TokenBodyParser, TokenStructureValidationError, } from '@dialectlabs/sdk';
export class AptosEd25519PayloadTokenBodyParser extends TokenBodyParser {
    parse(base64Body) {
        var _a, _b;
        const byteBody = bytesFromBase64(base64Body);
        const decoded = new TextDecoder().decode(byteBody);
        const signedPayload = (_b = (_a = decoded
            .split('\n')
            .find((it) => it.startsWith('message'))) === null || _a === void 0 ? void 0 : _a.split(':')[1]) === null || _b === void 0 ? void 0 : _b.trim();
        if (!signedPayload) {
            throw new TokenStructureValidationError();
        }
        const [headerBase64, bodyBase64] = signedPayload.split('.');
        if (!headerBase64 || !bodyBase64) {
            throw new TokenStructureValidationError();
        }
        return jsonParseFromBase64(bodyBase64);
    }
}
//# sourceMappingURL=aptos-ed25519-payload-token-body-parser.js.map